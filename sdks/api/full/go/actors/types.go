// This file was auto-generated by Fern from our API Definition.

package actors

import (
	json "encoding/json"
	fmt "fmt"
	uuid "github.com/google/uuid"
	sdk "sdk"
	builds "sdk/builds"
	core "sdk/core"
)

type CreateActorRequestQuery struct {
	Project      *string             `json:"-"`
	Environment  *string             `json:"-"`
	EndpointType *EndpointType       `json:"-"`
	Body         *CreateActorRequest `json:"-"`
}

func (c *CreateActorRequestQuery) UnmarshalJSON(data []byte) error {
	body := new(CreateActorRequest)
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	c.Body = body
	return nil
}

func (c *CreateActorRequestQuery) MarshalJSON() ([]byte, error) {
	return json.Marshal(c.Body)
}

type DestroyActorRequestQuery struct {
	Project     *string `json:"-"`
	Environment *string `json:"-"`
	// The duration to wait for in milliseconds before killing the actor. This should be used to override the default kill timeout if a faster time is needed, say for ignoring a graceful shutdown.
	OverrideKillTimeout *int64 `json:"-"`
}

type ListActorsRequestQuery struct {
	Project      *string       `json:"-"`
	Environment  *string       `json:"-"`
	EndpointType *EndpointType `json:"-"`
}

type GetActorsRequestQuery struct {
	Project          *string       `json:"-"`
	Environment      *string       `json:"-"`
	EndpointType     *EndpointType `json:"-"`
	TagsJson         *string       `json:"-"`
	IncludeDestroyed *bool         `json:"-"`
	Cursor           *string       `json:"-"`
}

type QueryActorsRequestQuery struct {
	Project     *string `json:"-"`
	Environment *string `json:"-"`
	// JSON-encoded query expression for filtering actors
	QueryJson *string `json:"-"`
	// Cursor for pagination
	Cursor *string `json:"-"`
}

type Actor struct {
	Id     sdk.Id           `json:"id"`
	Region string           `json:"region"`
	Tags   interface{}      `json:"tags,omitempty"`
	Build  uuid.UUID        `json:"build"`
	Ports  map[string]*Port `json:"ports,omitempty"`
	// The duration to wait for in milliseconds before force killing the actor after a DELETE request. This gives the actor time to perform a shutdown sequence before being killed. This should be set to a safe default, and can be overridden during a DELETE request if needed.
	KillTimeout *int64 `json:"kill_timeout,omitempty"`
	// If true, the actor will try to reschedule itself automatically in the event of a crash or a datacenter failover. The actor will not reschedule if it exits successfully.
	Durable     *bool          `json:"durable,omitempty"`
	CreatedAt   sdk.Timestamp  `json:"created_at"`
	StartedAt   *sdk.Timestamp `json:"started_at,omitempty"`
	DestroyedAt *sdk.Timestamp `json:"destroyed_at,omitempty"`

	_rawJSON json.RawMessage
}

func (a *Actor) UnmarshalJSON(data []byte) error {
	type unmarshaler Actor
	var value unmarshaler
	if err := json.Unmarshal(data, &value); err != nil {
		return err
	}
	*a = Actor(value)
	a._rawJSON = json.RawMessage(data)
	return nil
}

func (a *Actor) String() string {
	if len(a._rawJSON) > 0 {
		if value, err := core.StringifyJSON(a._rawJSON); err == nil {
			return value
		}
	}
	if value, err := core.StringifyJSON(a); err == nil {
		return value
	}
	return fmt.Sprintf("%#v", a)
}

type EndpointType string

const (
	EndpointTypeHostname EndpointType = "hostname"
	EndpointTypePath     EndpointType = "path"
)

func NewEndpointTypeFromString(s string) (EndpointType, error) {
	switch s {
	case "hostname":
		return EndpointTypeHostname, nil
	case "path":
		return EndpointTypePath, nil
	}
	var t EndpointType
	return "", fmt.Errorf("%s is not a valid %T", s, t)
}

func (e EndpointType) Ptr() *EndpointType {
	return &e
}

type Port struct {
	Protocol     builds.PortProtocol `json:"protocol,omitempty"`
	InternalPort *int                `json:"internal_port,omitempty"`
	Hostname     *string             `json:"hostname,omitempty"`
	Port         *int                `json:"port,omitempty"`
	Path         *string             `json:"path,omitempty"`
	// Fully formed connection URL including protocol, hostname, port, and path, if applicable.
	Url     *string             `json:"url,omitempty"`
	Routing *builds.PortRouting `json:"routing,omitempty"`

	_rawJSON json.RawMessage
}

func (p *Port) UnmarshalJSON(data []byte) error {
	type unmarshaler Port
	var value unmarshaler
	if err := json.Unmarshal(data, &value); err != nil {
		return err
	}
	*p = Port(value)
	p._rawJSON = json.RawMessage(data)
	return nil
}

func (p *Port) String() string {
	if len(p._rawJSON) > 0 {
		if value, err := core.StringifyJSON(p._rawJSON); err == nil {
			return value
		}
	}
	if value, err := core.StringifyJSON(p); err == nil {
		return value
	}
	return fmt.Sprintf("%#v", p)
}

type UpgradeActorRequestQuery struct {
	Project     *string              `json:"-"`
	Environment *string              `json:"-"`
	Body        *UpgradeActorRequest `json:"-"`
}

func (u *UpgradeActorRequestQuery) UnmarshalJSON(data []byte) error {
	body := new(UpgradeActorRequest)
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	u.Body = body
	return nil
}

func (u *UpgradeActorRequestQuery) MarshalJSON() ([]byte, error) {
	return json.Marshal(u.Body)
}

type UpgradeAllActorsRequestQuery struct {
	Project     *string                  `json:"-"`
	Environment *string                  `json:"-"`
	Body        *UpgradeAllActorsRequest `json:"-"`
}

func (u *UpgradeAllActorsRequestQuery) UnmarshalJSON(data []byte) error {
	body := new(UpgradeAllActorsRequest)
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	u.Body = body
	return nil
}

func (u *UpgradeAllActorsRequestQuery) MarshalJSON() ([]byte, error) {
	return json.Marshal(u.Body)
}

type GetActorUsageRequestQuery struct {
	Project     *string `json:"-"`
	Environment *string `json:"-"`
	// Start timestamp in milliseconds
	Start int `json:"-"`
	// End timestamp in milliseconds
	End int `json:"-"`
	// Time bucket interval in milliseconds
	Interval int `json:"-"`
	// JSON-encoded KeyPath for grouping results (e.g. {"property":"datacenter_id"} or {"property":"tags","map_key":"region"})
	GroupBy *string `json:"-"`
	// JSON-encoded query expression for filtering actors
	QueryJson *string `json:"-"`
}
